- name: Set APP_JAVA_HOME in systemd service using existing JAVA_HOME
  lineinfile:
    path: /etc/systemd/system/nexus.service
    regexp: '^Environment=APP_JAVA_HOME='
    line: 'Environment=APP_JAVA_HOME={{ lookup("env", "JAVA_HOME") }}'
    create: yes
  notify: restart_nexus_service

- name: Reload systemd after service file change
  systemd:
    daemon_reload: yes
